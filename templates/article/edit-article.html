{% extends "master.html" %}
{% block title %}{{ article.title }}{% endblock %}

{% block body %}
<article>
  <form method="post">
    <header>
        {% if wrong_version %}<h1 class="highlight">Wrong version of article submitted! Check live content to avoid overwriting edits!</h1>{% endif %}
          <h1>Title: <input type="text" required name="title" value="{{(article.title or '')|safe}}" /></h1>
          <h2>Subtitle: <input name="subtitle" type="text" value="{{(article.subtitle or '')|safe}}" /></h2>
          <p>Slug: <input name="slug" type="text" value="{{article.slug}}" /></p>
          <p>Posted by
            <select name="author">
              {% for author in authors %}
              <option value="{{author.slug}}" {% if (article.author_id != None) and (author==article.author) %}selected{% endif %}>{{author.name|safe}}</option>
              {% endfor %}
            </select>
            at <input name="time" type="time" value="{{time}}" required /> <input name="date" type="date" value="{{date}}" required/></p>
          <p>Tags:
            <input type="text" name="tags" value="{% for arttag in tags %}{{arttag.slug}}{% if not loop.last %},{% endif %}{% endfor %}" />
          </p>
          <p>Is article listed: <input type="checkbox" name="listed" {{ 'checked' if article.listed }} /></p>
          <p>Source code is written in this format: <input type="text" name="format" value="{{article.format}}" /> </p>
          <p>Encryption password (leave empty for unencrypted): <input type="password" name="password" value="{{password}}" /></p>
          <p>In previews, crop at paragraph: <input type="number" name="crop_at_paragraph" min="1" value="{{article.crop_at_paragraph}}" /></p>
          <p>In previews, crop with fading: <input type="checkbox" name="crop_with_fade" {{ 'checked' if article.crop_with_fade }} /></p>
          <input type="submit" />
      </header>

      <textarea name="content" rows="24" cols="80" required>{{ article_body|safe }}</textarea>

      <input type="hidden" name="version" value="{{ article.version }}" />
      <input type="hidden" name="action" value="edit" />
    </form>

      <hr><hr>
      <form method="post" action="{{url_for('article.delete_article', slug=article.slug)}}">
        <p>Deleting an article cannot be undone! Are you sure? <input type="checkbox" required name="confirm" /></p>
        <input type="submit" value="Delete this article!" />
      </form>

</article>
{% endblock %}
